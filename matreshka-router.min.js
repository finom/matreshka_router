!function(t,n){"function"==typeof define&&define.amd?define(["matreshka"],n):"object"==typeof module&&module.exports?module.exports=n(require("matreshka")):n(t.Matreshka)}(this,function(t){"use strict";function n(t){return t in n?n[t]:void(this.type=t)}if(!t)throw Error("Matreshka is missing");return t.extend(n.prototype,{parts:[],url:"/",hashBang:"!#/",init:function(){this.initialized||(t.linkProps(this,"parts","url",function(t){var n=t.replace(/\/\//g,"/").replace(/^\/|\/$/g,"");return n?n.split("/"):[]}),t.linkProps(this,"url","parts",function(t){for(var n=[],i=0;i<t.length&&t[i];i++)n.push(t[i]);return n.length?"/"+n.join("/")+"/":"/"}),t.linkProps(this,"hashBang","url",function(t){return t&&"/"!=t?"#!"+t:""}),t.linkProps(this,"url","hashBang",function(t){return t?t.replace(/^#!/,""):""}),t.on(this,"change:parts",function(n){var i=n.value,e=n.previousValue,r=i.length==e.length;if(r)for(var s=0;s<i.length;s++)if(i[s]!=e[s]){r=!1;break}r||t.trigger(this,"urlchange")}),"undefined"!=typeof window&&("hash"==this.type?(window.addEventListener("hashchange",function(){t.set(this,"hashBang",location.hash,{hashEvent:!0})}.bind(this)),t.onDebounce(this,"change:hashBang",function(t){t&&t.hashEvent||(location.hash=this.hashBang)},!0)):"history"==this.type&&(window.addEventListener("popstate",function(n){n.state&&n.state.azaza&&t.set(this,"url",location.pathname,{popEvent:!0})}.bind(this)),t.onDebounce(this,"change:url",function(t){t&&t.popEvent||history.pushState({azaza:!0},"",this.url+location.hash)},!0))),this.initialized=!0)},subscribe:function(n,i){var e=i.replace(/\/\//g,"/").replace(/^\/|\/$/g,"").split("/"),r=e.filter(function(t){return"*"!=t}),s=[];this.init(),t.on(n,r.map(function(t){return"change:"+t}).join(" "),function(t){if(!t||!t.routeSilent){for(var i=[],r=0;r<e.length;r++)if("*"!=e[r]){if(!n[e[r]])break;i.push(n[e[r]])}else{if(!this.parts[r])break;i.push(this.parts[r])}this.parts=i}},this),t.on(this,"urlchange",function(){for(var i=0;i<e.length;i++)"*"!=e[i]&&t.set(n,e[i],this.parts[i]||null,{routeSilent:!0})});for(var h=0;h<e.length;h++)s.push("*"==n[e[h]]?this.parts[h]:n[e[h]]||this.parts[h]);return this.parts=s,this}}),t.Router=n,t.Router.history=new n("history"),t.Router.hash=new n("hash"),t.initRouter=function(n,i,e){return t.Router[e||"hash"].subscribe(n,i),n},t.prototype.initRouter=function(n,i){return t.Router[i||"hash"].subscribe(this,n),this},n});
//# sourceMappingURL=matreshka-router.min.js.map

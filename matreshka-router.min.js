!function(t,e){"function"==typeof define&&define.amd?define(["matreshka"],e):"object"==typeof module&&module.exports?module.exports=e(require("matreshka")):e(t.Matreshka)}(this,function(t){"use strict";function e(t){return t in e?e[t]:void(this.type=t)}if(!t)throw Error("Matreshka is missing");var n=t.linkProps,r=t.onDebounce,i=t.on,a="undefined"!=typeof window?window:null;return t.extend(e.prototype,{parts:[],url:"/",hashBang:"!#/",init:function(){if(!this.initialized){var e=this,s=e.type,u=document.location;return n(e,"parts","url",function(t){var e=t.replace(/\/\//g,"/").replace(/^\/|\/$/g,"");return e?e.split("/"):[]}),n(e,"url","parts",function(t){var e,n=[];for(e=0;e<t.length&&t[e];e++)n.push(t[e]);return n.length?"/"+n.join("/")+"/":"/"}),n(e,"hashBang","url",function(t){return t&&"/"!=t?"#!"+t:""}),n(e,"url","hashBang",function(t){return t?t.replace(/^#!/,""):""}),i(e,"change:parts",function(n){var r,i=n.value,a=n.previousValue,s=i.length==a.length;if(s)for(r=0;r<i.length;r++)if(i[r]!=a[r]){s=!1;break}s||t.trigger(e,"urlchange")}),a&&("hash"==s?(a.addEventListener("hashchange",function(){t.set(e,"hashBang",u.hash,{hashEvent:!0})}),r(e,"change:hashBang",function(t){t&&t.hashEvent||(u.hash=e.hashBang)},!0)):"history"==s&&(a.addEventListener("popstate",function(n){n.state&&n.state.validPush&&t.set(e,"url",u.pathname,{popEvent:!0})}),r(e,"change:url",function(t){t&&t.popEvent||history.pushState({validPush:!0},"",e.url+u.hash)},!0))),e.initialized=!0,e}},subscribe:function(e,n){var r,a=this,s=n.replace(/\/\//g,"/").replace(/^\/|\/$/g,"").split("/"),u=s.filter(function(t){return"*"!=t}),h=[];for(a.init(),i(e,u.map(function(t){return"change:"+t}).join(" "),function(t){if(!t||!t.routeSilent){var n,r=[];for(n=0;n<s.length;n++)if("*"!=s[n]){if(!e[s[n]])break;r.push(e[s[n]])}else{if(!a.parts[n])break;r.push(a.parts[n])}a.parts=r}}),i(a,"urlchange",function(){var n;for(n=0;n<s.length;n++)"*"!=s[n]&&t.set(e,s[n],a.parts[n]||null,{routeSilent:!0})}),r=0;r<s.length;r++)h.push("*"==e[s[r]]?a.parts[r]:e[s[r]]||a.parts[r]);return a.parts=h,a}}),t.Router=e,t.Router.history=new e("history"),t.Router.hash=new e("hash"),t.initRouter=function(e,n,r){return t.Router[r||"hash"].subscribe(e,n),e},t.prototype.initRouter=function(e,n){return t.Router[n||"hash"].subscribe(this,e),this},e});
//# sourceMappingURL=matreshka-router.min.js.map

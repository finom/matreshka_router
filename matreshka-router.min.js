!function(t,n){"function"==typeof define&&define.amd?define(["matreshka"],n):"object"==typeof module&&module.exports?module.exports=n(require("matreshka")):n(t.Matreshka)}(this,function(t){"use strict";function n(t){return t in n?n[t]:void(this.type=t)}if(!t)throw Error("Matreshka is missing");var e=t.linkProps,r=t.onDebounce,i=t.on,a=t.set,h="undefined"!=typeof window?window:null;return t.extend(n.prototype,{parts:[],url:"/",hashBang:"!#/",init:function(){if(!this.initialized){var n=this,u=n.type,s=document.location;return e(n,"parts","url",function(t){var n=t.replace(/\/\//g,"/").replace(/^\/|\/$/g,"");return n?n.split("/"):[]}),e(n,"url","parts",function(t){var n,e=[];for(n=0;n<t.length&&t[n];n++)e.push(t[n]);return e.length?"/"+e.join("/")+"/":"/"}),e(n,"hashBang","url",function(t){return t&&"/"!=t?"#!"+t:""}),e(n,"url","hashBang",function(t){return t?t.replace(/^#!/,""):""}),i(n,"change:parts",function(e){var r,i=e.value,a=e.previousValue,h=i.length==a.length;if(h)for(r=0;r<i.length;r++)if(i[r]!=a[r]){h=!1;break}h||t.trigger(n,"urlchange")}),h&&("hash"==u?(h.addEventListener("hashchange",function(){a(n,"hashBang",s.hash,{hashEvent:!0})}),r(n,"change:hashBang",function(t){t&&t.hashEvent||(s.hash=n.hashBang)},!0)):"history"==u&&(h.addEventListener("popstate",function(t){t.state&&t.state.validPush&&a(n,"url",s.pathname,{popEvent:!0})}),r(n,"change:url",function(t){t&&t.popEvent||history.pushState({validPush:!0},"",n.url+s.hash)},!0))),n.initialized=!0,n}},subscribe:function(t,n){var e,r=this,h=n.replace(/\/\//g,"/").replace(/^\/|\/$/g,"").split("/"),u=[],s=(h.filter(function(t){return"*"!=t}),[]);for(r.init(),e=0;e<h.length;e++)"*"!=h[e]&&u.push("change:"+h[e]);for(i(t,u,function(n){if(!n||!n.routeSilent){var e,i,a=[];for(e=0;e<h.length&&(i="*"==h[e]?r.parts[e]:t[h[e]],i);e++)a.push(i);r.parts=a}}),i(r,"urlchange",function(){var n;for(n=0;n<h.length;n++)"*"!=h[n]&&a(t,h[n],r.parts[n]||null,{routeSilent:!0})}),e=0;e<h.length;e++)s.push("*"==t[h[e]]?r.parts[e]:t[h[e]]||r.parts[e]);return r.parts=s,r}}),t.Router=n,t.Router.history=new n("history"),t.Router.hash=new n("hash"),t.initRouter=function(n,e,r){return t.Router[r||"hash"].subscribe(n,e),n},t.prototype.initRouter=function(n,e){return t.Router[e||"hash"].subscribe(this,n),this},n});
//# sourceMappingURL=matreshka-router.min.js.map
